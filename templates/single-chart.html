{% extends "base.html" %}

{% block title %}{{ query }}{% endblock %}

{% block head %}
{{ super() }}
<script src=https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js></script>
<style type="text/css">
 canvas {
      width: 100%;
      height: auto;
 }
</style>
{% endblock %}

{% block content %}
<h1>Chart for query: {{ query }}</h1>
<canvas id="chart" width="400" height="100"></canvas>
<script>
 window.onload = function () {
     var cv = document.getElementById("chart")
     var ctx = cv.getContext("2d");
     var chart = new Chart(ctx, {{ chart_params|tojson|safe }});
 
     if ({{ chart_params['components-linked']|tojson|safe }}) {
         cv.onclick = function(evt) {
             var point = chart.getElementAtEvent(evt)[0];
     
             if (point) {
                 var candidate_link = chart.data.links[point._index];
                 window.location.href = candidate_link;
             }
         }
     }
 };
</script>
{% endblock %}
