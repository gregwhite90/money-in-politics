{% extends "base.html" %}

{% block title %}{{ query }}{% endblock %}

{% block head %}
{{ super() }}
<script src=https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js></script>
<style type="text/css">
 canvas {
      width: 100%;
      height: auto;
 }
</style>
{% endblock %}

{% block content %}
<h1>Chart for query: {{ query }}</h1>
<canvas id="chart" width="400" height="100"></canvas>
<script>
 var cv = document.getElementById("chart")
 var ctx = cv.getContext("2d");
 var chart = new Chart(ctx, {
     type: {{ chart_params['type']|tojson|safe }},
     data: {
         labels: {{ chart_params['labels']|tojson|safe }},
         datasets: [{
             label: "2016 Presidential Election Total Receipts",
             data: {{ chart_params['values']|tojson|safe }},
             links: {{ chart_params['candidate_links']|tojson|safe }}
         }]
     }
 });

 cv.onclick = function(evt) {
     var point = chart.getElementAtEvent(evt)[0];
     
     if (point) {
         var candidate_link = chart.data.datasets[point._datasetIndex].
                                    links[point._index];
         window.location.href = candidate_link;
     }
 }
</script>
{% endblock %}
